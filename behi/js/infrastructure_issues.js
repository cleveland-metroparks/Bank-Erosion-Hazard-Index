
var geoJson1 = [{
"type": "Feature", "id": 1, "properties": { "Date": 41499, "location": "Acacia", "uid": "a1", "Latitude": 41.50164, "Longitude": -81.491276999999897, "info": "Two metal pipes running perpendicular to flow. Perched 2.5 feet above water surface. Coming from maintenance shed on right bank approximately 50 feet from stream.  Pipes rusted though.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/acacia/G130813-0003.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.491276999999897, 41.50164 ] } }
,
{ "type": "Feature", "id": 2, "properties": { "Date": 41499, "location": "Acacia", "uid": "a2", "Latitude": 41.501838084770199, "Longitude": -81.4912077483133, "info": "Rusted metal pipe perpendicular to flow. Perched 3 feet above water surface. Attached to banks. Unknown source/purpose.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/acacia/G130813-0006.jpg'],['images/stream_banks/acacia/G130813-0007.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.4912077483133, 41.501838084770199 ] } }
,
{ "type": "Feature", "id": 3, "properties": { "Date": 41499, "location": "Acacia", "uid": "a3", "Latitude": 41.502261618595902, "Longitude": -81.491349132302503, "info": "Erosion on blacktop connected to bridge. 2 feet erosion. Located on the left stream bank on upstream corner of bridge.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/acacia/G130813-0008.jpg'],['images/stream_banks/acacia/G130813-0009.jpg'],['images/stream_banks/acacia/G130813-0010.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.491349132302503, 41.502261618595902 ] } }
,
{ "type": "Feature", "id": 4, "properties": { "Date": 41499, "location": "Acacia", "uid": "a4", "Latitude": 41.502508317821302, "Longitude": -81.491441556549802, "info": "Two metal pipes perpendicular to flow. Perched 3.5 feet above water surface. Exposed wires from smaller pipe on right bank. Unknown source/purpose.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/acacia/G130813-0011.jpg'],['images/stream_banks/acacia/G130813-0012.jpg'],['images/stream_banks/acacia/G130813-0013.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.491441556549802, 41.502508317821302 ] } }
,
{ "type": "Feature", "id": 5, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m1", "Latitude": 41.416538121717601, "Longitude": -81.638888905267095, "info": "Failed revetment. Black lining and large concrete slabs in stream. Left stream bank.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0036.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.638888905267095, 41.416538121717601 ] } }
,
{ "type": "Feature", "id": 6, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m2", "Latitude": 41.417834999999897, "Longitude": -81.638395, "info": "Culvert on right bank (flowing water) showing signs of pollution source due to increased iron producing bacteria (orange).", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0010.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.638395, 41.417834999999897 ] } }
,
{ "type": "Feature", "id": 7, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m3", "Latitude": 41.418047, "Longitude": -81.637517, "info": "Failed revetment. Plastic fencing not attached to bank at toe. Rebar throughout bank not working and exposed in stream. Approximately 90 feet in length on left bank. Erosion is ooccuring in sections. Outside of meander bend. Gabion baskets behind plastic fencing,  some areas failed.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0011.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.637517, 41.418047 ] } }
,
{ "type": "Feature", "id": 8, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m4", "Latitude": 41.419087111136101, "Longitude": -81.636760695035505, "info": "Failed gabion baskets (rock revetment missing). Bank is exposed. Approximately 100 feet in length on left bank.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0016.jpg'],['images/stream_banks/mill_creek/G130910-0017.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.636760695035505, 41.419087111136101 ] } }
,
{ "type": "Feature", "id": 9, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m5", "Latitude": 41.420520398105801, "Longitude": -81.635299674344793, "info": "Failed train track. Large woody debris jam upstream.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0020.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.635299674344793, 41.420520398105801 ] } }
,
{ "type": "Feature", "id": 10, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m6", "Latitude": 41.424247818782703, "Longitude": -81.637400657584095, "info": "Failed revetment. Large concrete slabs in stream. Outside meander. Erosion occuring on left stream bank. Fence to adjacent property within 20 ft of stream.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0030.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.637400657584095, 41.424247818782703 ] } }
,
{ "type": "Feature", "id": 11, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m7", "Latitude": 41.424015101492003, "Longitude": -81.637502522690994, "info": "Failed revetment. Concrete slabs in stream. Evidence of old bridge/maintenance road. Right bank.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0034.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.637502522690994, 41.424015101492003 ] } }
,
{ "type": "Feature", "id": 12, "properties": { "Date": 41527, "location": "Mill Creek", "uid": "m8", "Latitude": 41.419209736288501, "Longitude": -81.636900925113096, "info": "Failed revetment. Plastic fencing no longer attached to bank at toe. Exposed rebar. Slumping stream bank. Approximately 10 feet in length on left bank.", "marker-color": "#000", "marker-size": "small", "images1": [['images/stream_banks/mill_creek/G130910-0014.jpg'],['images/stream_banks/mill_creek/G130910-0015.jpg']] }, "geometry": { "type": "Point", "coordinates": [ -81.636900925113096, 41.419209736288501 ] } }
,
{ "type": "Feature", "id": 13, "properties": { "Date": 41484, "location": "Sagamore Creek", "uid": "sa1", "Latitude": 41.352833652225499, "Longitude": -81.584228617654702, "info": "Culvert damage -water flowing under culvert through rusted bottom of culvert. Perched. Severe debris jam on the upstream of culvert.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/sagamore/G130729-0025.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.584228617654702, 41.352833652225499 ] } }
,
{ "type": "Feature", "id": 14, "properties": { "Date": 41485, "location": "Sagamore Creek", "uid": "sa2", "Latitude": 41.350345152449698, "Longitude": -81.592957451932904, "info": "Exposed active petroleum pipeline. Perpendicular to flow. Perched above water. Boulder build-up on upstream end.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/sagamore/G130730-0012.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.592957451932904, 41.350345152449698 ] } }
,
{ "type": "Feature", "id": 15, "properties": { "Date": 41485, "location": "Sagamore Creek", "uid": "sa3", "Latitude": 41.351152999999897, "Longitude": -81.592658, "info": "Channel restricted by bridge. Photo taken at normal flow. Top of water is 2.5 inches below bridge.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/sagamore/G130730-0019.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.592658, 41.351152999999897 ] } }
,
{ "type": "Feature", "id": 16, "properties": { "Date": 41486, "location": "Sulfur Springs", "uid": "su1", "Latitude": 41.425148192212198, "Longitude": -81.418247266727604, "info": "Severely undercut concrete revetment wall.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/sulphur/july31/G130731-0008.jpg"],["images/stream_banks/sulphur/july31/G130731-0009.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.418247266727604, 41.425148192212198 ] } }
,
{ "type": "Feature", "id": 17, "properties": { "Date": 41492, "location": "Sulfur Springs", "uid": "su2", "Latitude": 41.417948858641601, "Longitude": -81.424737965316893, "info": "Undercut trail by 2 feet. Outside of meander bend. Perched tributary. Very high BEHI ranking.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/sulphur/aug6/G130806-0003.jpg"],["images/stream_banks/sulphur/aug6/G130806-0004.jpg"],["images/stream_banks/sulphur/aug6/G130806-0005.jpg"],["images/stream_banks/sulphur/aug6/G130806-0006.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.424737965316893, 41.417948858641601 ] } }
,
{ "type": "Feature", "id": 18, "properties": { "Date": 41492, "location": "Sulfur Springs", "uid": "su3", "Latitude": 41.415625988210302, "Longitude": -81.429076553652195, "info": "Erosion on right bank 6 feet from road. Outside meander. High BEHI ranking.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/sulphur/aug6/G130806-0060.jpg"],["images/stream_banks/sulphur/aug6/G130806-0061.jpg"],["images/stream_banks/sulphur/aug6/G130806-0062.jpg"],["images/stream_banks/sulphur/aug6/G130806-0063.jpg"],["images/stream_banks/sulphur/aug6/G130806-0064.jpg"]]  }, "geometry": { "type": "Point", "coordinates": [ -81.429076553652195, 41.415625988210302 ] } }
,
{ "type": "Feature", "id": 19, "properties": { "Date": 41493, "location": "Sulfur Springs", "uid": "su4", "Latitude": 41.4144276899492, "Longitude": -81.432457626739605, "info": "Severe erosion around culvert. Concrete winged wall in suspension. Perched culvert to the right of winged wall. Extremely deep pool formed by scow beneath culvert.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/sulphur/aug7/G130807-0012.jpg"],["images/stream_banks/sulphur/aug7/G130807-0013.jpg"],["images/stream_banks/sulphur/aug7/G130807-0014.jpg"],["images/stream_banks/sulphur/aug7/G130807-0015.jpg"],["images/stream_banks/sulphur/aug7/G130807-0016.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.432457626739605, 41.4144276899492 ] } }
,
{ "type": "Feature", "id": 20, "properties": { "Date": 41526, "location": "Timberlane", "uid": "t1", "Latitude": 41.281956999999899, "Longitude": -81.757247, "info": "Perched cement culvert (2.5 feet in diameter). Drainage ditch coming off right side on  bank. Black fabric ripped and removed. Rock revetment blocking main channel. Scour downstream of culvert. Undercutting on left bank.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/timberlane/sept9/G130909-0013.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.757247, 41.281956999999899 ] } }
,
{ "type": "Feature", "id": 21, "properties": { "Date": 41534, "location": "Timberlane", "uid": "t2", "Latitude": 41.278797475119902, "Longitude": -81.754539721917297, "info": "Culvert against right bank, out of place, flow to left of culvert.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/timberlane/sept16/G130917-0031.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.754539721917297, 41.278797475119902 ] } }
,
{ "type": "Feature", "id": 22, "properties": { "Date": 41534, "location": "Timberlane", "uid": "t3", "Latitude": 41.278512999999897, "Longitude": -81.754589999999894, "info": "Two culverts 2.5 feet in diameter.  Perched .5 feet above water surface. Flow coming from below culvert. Scour and debris jam on upstream end. Culvert not functioning.", "marker-color": "#000", "marker-size": "small", "images1": [["images/stream_banks/timberlane/sept16/G130917-0032.jpg"],["images/stream_banks/timberlane/sept16/G130917-0033.jpg"]] }, "geometry": { "type": "Point", "coordinates": [ -81.754589999999894, 41.278512999999897 ] } }

];


var infrastructure = map3.markerLayer.on('layeradd', function(e) {
    var markers1 = e.layer;
    var feature = markers1.feature;
    var photos = feature.properties.images1
    var slideshowContent1 = '';

    for(var i = 0; i < photos.length; i++) {
        var img1 = photos[i];

        slideshowContent1 += '<div class="image' + (i === 0 ? ' active' : '') + '">' +
                              '<img src="' + img1[0] + '" />' + '</div>';
    }

    // Create custom popup content
    var popupContent1 = '<div id="' + feature.properties.id + '" class="popup">' +
                            '<div class="slideshow">' +
                                slideshowContent1 +
                            '</div>' +
							'<p>' + feature.properties.info + '</p>' +
                            '<div class="cycle">' +
                                '<a href="#" class="prev" onclick="return moveSlide(\'prev\')">&laquo; Previous</a>' +
                                '<a href="#" class="next" onclick="return moveSlide(\'next\')">Next &raquo;</a>' +
                            '</div>'
                        '</div>';

    // http://leafletjs.com/reference.html#popup
    markers1.bindPopup(popupContent1,{
        closeButton: true,
        minWidth: 320
    });
});

// Add features to the map

map3.markerLayer.setGeoJSON(geoJson1);



// This example uses jQuery to make selecting items in the slideshow easier
// Creates the functionality for the next/prev buttons for the image slideshow
function moveSlide(direction) {
    var $slideshow1 = $('.slideshow'),
        totalSlides = $slideshow1.children().length;

    if (direction === 'prev') {
        var $newSlide1 = $slideshow1.find('.active').prev();
        if ($newSlide1.index() < 0) {
            $newSlide1 = $('.image').last();
        }
    } else {
        var $newSlide1 = $slideshow1.find('.active').next();
        if ($newSlide1.index() < 0) {
            $newSlide1 = $('.image').first();
        }
    }

    $slideshow1.find('.active').removeClass('active').hide();
    $newSlide1.addClass('active').show();
    return false;
}


// Add layers to turn on/off
// Cleveland Metroparks trails app base layer
var parks = L.tileLayer('http://maps1.clemetparks.com/tilestache/tilestache.cgi/basemap/{z}/{x}/{y}.jpg', {
    attribution: 'Map data <a href="http://clevelandmetroparks.com" target="_blank">Cleveland Metroparks</a>, Imagery <a href="http://maps.clevelandmetroparks.com" target="_blank">Cleveland Metroparks</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	minZoom: 10,
    maxZoom: 18
}).addTo(map3);


// Mapbox satellite base layer
var imagery = L.tileLayer('http://a.tiles.mapbox.com/v3/cminvasiveplants.map-7cfqm6fy/{z}/{x}/{y}.jpg', {
    attribution: 'Map data <a href="http://clevelandmetroparks.com" target="_blank">Cleveland Metroparks</a>, Imagery &copy <a href="http://mapbox.com" target="_blank">MapBox</a>',
	minZoom: 10,	
    maxZoom: 18
});

// Adds the base layers to the layer controller
// format=     "Layer label in the controller" : variable name given above,
var baseMaps = {
	"Cleveland Metroparks":parks,
	"Satellite":imagery
};

// Add the overlay layers to the layer controller
// format=     "Layer label in the controller" : variable name given above,
var overlayMaps = null;

// Adds layer controller
L.control.layers(baseMaps).addTo(map3);

map3.setView([41.3902, -81.6682], 11);


